<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Cahier dâ€™Anglais â€“ V3 (Benny) â€¢ ColorÃ© & Fun</title>
<style>
:root{
  --primary:#7C3AED; --secondary:#06B6D4; --accent:#22C55E;
  --bg:#F6F8FE; --card:#FFFFFF; --ink:#0f172a; --muted:#64748b;
  --ok:#16a34a; --err:#ef4444; --warn:#f59e0b; --line:#e5e7eb;
}
*{box-sizing:border-box}
html,body{margin:0;padding:0}
body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--ink);background:var(--bg);line-height:1.6}
header{background:linear-gradient(120deg,var(--primary),#4F46E5 60%, var(--secondary));color:#fff;padding:28px 16px;text-align:center}
header h1{margin:0 0 6px;font-size:28px}
header p{margin:0;font-size:15px;opacity:.95}
nav.top{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;padding:12px;background:#eef2ff;border-bottom:1px solid var(--line)}
nav.top a{background:#4F46E5;color:#fff;text-decoration:none;padding:8px 12px;border-radius:999px;font-weight:800;font-size:13px}
nav.top a:hover{filter:brightness(.95)}
main{max-width:1100px;margin:22px auto;padding:0 14px}
section{background:var(--card);border:1px solid var(--line);border-radius:14px;margin:16px 0;padding:18px}
h2{margin:0 0 12px;color:#312e81;font-size:22px}
h3{margin:16px 0 8px;color:#334155;font-size:18px}
.muted{color:var(--muted);font-size:13px}
.card{background:#fafaff;border:1px dashed var(--line);border-radius:12px;padding:12px;margin:10px 0}
.badge{display:inline-block;padding:3px 8px;border-radius:999px;background:#ecfeff;color:#155e75;font-weight:800;font-size:12px;margin-left:6px}
.table{width:100%;border-collapse:separate;border-spacing:0}
.table th,.table td{padding:10px 8px;border-bottom:1px solid #eef2ff;font-size:15px;vertical-align:top}
.table th{background:#EEF2FF;color:#312e81;text-align:left}
.row{display:grid;grid-template-columns:1fr;gap:12px}
@media(min-width:920px){.row{grid-template-columns:1fr 1fr}}
.grid3{display:grid;grid-template-columns:1fr;gap:12px}
@media(min-width:980px){.grid3{grid-template-columns:1fr 1fr 1fr}}
input[type="text"], textarea, select{
  width:100%;padding:10px 12px;border:1px solid #dbeafe;border-radius:10px;background:#fff;font-size:15px
}
button{background:linear-gradient(120deg,#4F46E5,var(--primary));border:none;color:#fff;font-weight:800;
  padding:10px 14px;border-radius:12px;cursor:pointer}
button.secondary{background:#e0e7ff;color:#3730a3}
button.ghost{background:#fff;border:1px solid var(--line);color:#334155}
.result{font-weight:800;margin-top:6px}
.ok{color:var(--ok)} .err{color:var(--err)} .warn{color:var(--warn)}
.kbd{display:inline-block;border:1px solid var(--line);border-bottom-width:3px;border-radius:8px;padding:2px 8px;background:#fff;font-weight:800}
.tools{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0}
.right{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end}
details{background:#f8fafc;border:1px solid #e2e8f0;border-radius:10px;padding:10px;margin:10px 0}
details>summary{cursor:pointer;font-weight:800;color:#334155}
hr.sep{border:0;border-top:1px solid var(--line);margin:14px 0}
.small{font-size:13px}
footer{padding:28px 16px;text-align:center;color:#64748b}
.print-note{display:inline-block;background:#fff3cd;border:1px solid #ffe69c;color:#7a5b00;padding:6px 10px;border-radius:8px}
</style>
</head>
<body>

<header>
  <h1>Cahier dâ€™Anglais â€“ V3 (Benny)</h1>
  <p>ColorÃ©, fun et 100% interactif â€” Conversation â€¢ Vocabulaire â€¢ Grammaire â€¢ Builder de questions â€¢ Dialogues â€¢ Exercices â€¢ Prononciation</p>
</header>

<nav class="top">
  <a href="#accueil">Accueil</a>
  <a href="#builder">Question Builder</a>
  <a href="#gram">Grammaire</a>
  <a href="#vocab">Vocabulaire</a>
  <a href="#flashcards">Flashcards</a>
  <a href="#scenarios">Dialogues & ScÃ©narios</a>
  <a href="#exos">Exercices</a>
  <a href="#prononciation">Prononciation</a>
  <a href="#checklist">Checklist</a>
  <a href="#export">Exporter PDF</a>
  <a href="#reponses">RÃ©ponses</a>
</nav>

<main>

<!-- ACCUEIL -->
<section id="accueil">
  <h2>Bienvenue Benny ğŸ‘‹</h2>
  <div class="row">
    <div class="card">
      <h3>Ton plan de progression <span class="badge">4 semaines</span></h3>
      <ul>
        <li>ğŸ—£ï¸ Parler 5â€“10 min / jour (avec ton amie ou Ã  voix haute).</li>
        <li>ğŸ“š 10 mots / expressions par jour (section Vocabulaire + Flashcards).</li>
        <li>ğŸ§© 1 point de grammaire par jour (section Grammaire + Builder).</li>
        <li>ğŸ­ 2 scÃ¨nes rÃ©elles / semaine (section Dialogues & ScÃ©narios).</li>
      </ul>
      <p class="muted small">Astuce : <span class="kbd">Ctrl/Cmd + P</span> â†’ â€œEnregistrer en PDFâ€ pour imprimer un module.</p>
    </div>
    <div class="card">
      <h3>Mode dâ€™emploi</h3>
      <ul>
        <li>Lis â†’ RÃ©pÃ¨te â†’ Ã‰cris â†’ Utilise (dans une vraie conversation).</li>
        <li>Utilise le <a href="#builder"><b>Question Builder</b></a> pour formuler sans fautes.</li>
        <li>Fais les exos et compare dans <a href="#reponses">RÃ©ponses</a>.</li>
        <li>âœ… Coche la <a href="#checklist">Checklist</a> (sauvegarde locale).</li>
      </ul>
    </div>
  </div>
</section>

<!-- QUESTION BUILDER -->
<section id="builder">
  <h2>Question Builder (anti-fautes) ğŸ¯</h2>
  <p class="muted">Compose une question correcte en choisissant les Ã©lÃ©ments. Le Builder gÃ¨re lâ€™auxiliaire, lâ€™ordre et le temps.</p>
  <div class="tools">
    <select id="wh">
      <option value="">(Wh-word)</option>
      <option>What</option><option>Where</option><option>When</option>
      <option>Why</option><option>How</option><option>How long</option><option>Who</option>
    </select>
    <select id="tense">
      <option value="">(Temps)</option>
      <option value="psimple">PrÃ©sent simple</option>
      <option value="pcont">PrÃ©sent continu</option>
      <option value="past">PassÃ© simple</option>
      <option value="will">Futur (will)</option>
      <option value="perf">Present perfect</option>
    </select>
    <select id="subj">
      <option value="">(Sujet)</option>
      <option>I</option><option>You</option><option>He</option><option>She</option><option>We</option><option>They</option>
    </select>
    <input id="verb" type="text" placeholder="Verbe base (ex: work / be / go)" />
    <input id="compl" type="text" placeholder="ComplÃ©ment (ex: at the office / dinner)" />
    <input id="time" type="text" placeholder="Indication de temps (ex: today / yesterday / since 2022)" />
    <button onclick="buildQ()">Construire la question</button>
  </div>
  <div id="qOut" class="card"></div>
  <p class="small muted">Rappels : verbe <b>be</b> â†’ pas de â€œdo/does/didâ€. Present perfect = <b>have/has + V-en</b>. PrÃ©sent continu = <b>be + V-ing</b>.</p>
</section>

<!-- GRAMMAIRE -->
<section id="gram">
  <h2>Grammaire â€” fiches claires</h2>
  <div class="row">
    <div class="card">
      <h3>Former des questions (ordre & auxiliaires)</h3>
      <ul>
        <li><b>Do/Does + sujet + base</b> (prÃ©sent) : Do you like coffee? / Does she work?</li>
        <li><b>Did + sujet + base</b> (passÃ©) : Did you go yesterday?</li>
        <li><b>Be + sujet + V-ing</b> : Are you working now?</li>
        <li><b>Have/Has + sujet + V-en</b> : Have you finished?</li>
        <li><b>Wh-word + auxiliaire + sujet + verbe</b> : Where do you live?</li>
      </ul>
      <div class="card small muted">âš ï¸ Avec <b>be</b> : Where <u>are</u> you? (pas *do you are*)</div>
    </div>
    <div class="card">
      <h3>Temps â€” quand les utiliser</h3>
      <ul>
        <li><b>Present Simple</b> : habitudes / vÃ©ritÃ©s â€” I work on Mondays.</li>
        <li><b>Present Continuous</b> : maintenant / plan â€” Iâ€™m cooking / Iâ€™m meeting her at 8.</li>
        <li><b>Past Simple</b> : action finie â€” We visited Rome last year.</li>
        <li><b>Will</b> : dÃ©cision instantanÃ©e / promesse â€” Iâ€™ll call you.</li>
        <li><b>Be going to</b> : intention / signe â€” Iâ€™m going to cook pasta.</li>
        <li><b>Present Perfect</b> : expÃ©rience / durÃ©e â€” Iâ€™ve lived here for 3 years.</li>
      </ul>
    </div>
  </div>
  <details>
    <summary><b>Erreurs frÃ©quentes â†’ versions correctes</b></summary>
    <ul>
      <li>*How long do you living here?* â†’ âœ… <b>How long have you been living here?</b></li>
      <li>*What time lives your train?* â†’ âœ… <b>What time does your train leave?</b></li>
      <li>*Who have cooked the evening?* â†’ âœ… <b>Who cooked dinner?</b> / <b>Who has cooked dinner?</b></li>
      <li>*How many for this T-shirt?* â†’ âœ… <b>How much is this T-shirt?</b></li>
    </ul>
  </details>
</section>

<!-- VOCABULAIRE (dynamique) -->
<section id="vocab">
  <h2>Vocabulaire â€” bibliothÃ¨que (100+ items)</h2>
  <div class="tools">
    <input id="vSearch" type="text" placeholder="ğŸ” Cherche un mot (en/fr/phonÃ©tique) â€” ex: dress / robe / river" />
    <select id="vCat">
      <option value="">(Toutes catÃ©gories)</option>
      <option value="home">Maison</option>
      <option value="city">Ville & nature</option>
      <option value="food">Nourriture & resto</option>
      <option value="travel">Voyage</option>
      <option value="feelings">Ã‰motions</option>
      <option value="work">Travail</option>
      <option value="compl">Compliments & style</option>
      <option value="olive">Huile dâ€™olive</option>
    </select>
    <button class="secondary" onclick="renderVocab()">Rechercher</button>
    <button class="ghost" onclick="resetVocab()">Reset</button>
  </div>
  <table class="table" id="vTable">
    <thead><tr><th>Anglais</th><th>PhonÃ©tique</th><th>FranÃ§ais</th><th>Exemple</th><th>Cat.</th></tr></thead>
    <tbody></tbody>
  </table>
  <p class="small muted">Astuce : clique <a href="#flashcards">Flashcards</a> pour tâ€™entraÃ®ner vite par thÃ¨me.</p>
</section>

<!-- FLASHCARDS -->
<section id="flashcards">
  <h2>Flashcards â€” entraÃ®nement rapide</h2>
  <div class="tools">
    <select id="fcSelect">
      <option value="home">Maison</option>
      <option value="city">Ville & nature</option>
      <option value="food">Nourriture & resto</option>
      <option value="travel">Voyage</option>
      <option value="feelings">Ã‰motions</option>
      <option value="compl">Compliments & style</option>
      <option value="olive">Huile dâ€™olive</option>
    </select>
    <button class="secondary" onclick="fcPrev()">â—€ï¸ PrÃ©c</button>
    <button onclick="fcFlip()">Retourner</button>
    <button class="secondary" onclick="fcNext()">Suiv â–¶ï¸</button>
  </div>
  <div class="card" id="fcCard" onclick="fcFlip()">Clique pour retourner la carteâ€¦</div>
  <p class="muted small">Raccourcis : <span class="kbd">â†</span> / <span class="kbd">â†’</span> / <span class="kbd">Espace</span></p>
</section>

<!-- SCENARIOS -->
<section id="scenarios">
  <h2>Dialogues & ScÃ©narios (Rome â€¢ Restaurant â€¢ Amis â€¢ Oliveraie)</h2>

  <details open>
    <summary><b>ğŸ§­ Promenade Ã  Rome (prÃ©sent / prÃ©sent continu)</b></summary>
    <div class="card" id="romeBox">
      <p><b>ScÃ¨ne 1.</b> Youâ€™re near the Trevi Fountain. Choose a natural line:</p>
      <label><input type="radio" name="rome1" value="a"> Do you want we go throw a coin?</label><br>
      <label><input type="radio" name="rome1" value="b"> Shall we throw a coin? It brings good luck!</label><br>
      <label><input type="radio" name="rome1" value="c"> We are throw a coin now?</label>
      <hr class="sep">
      <p><b>ScÃ¨ne 2.</b> Sheâ€™s taking photos. You say:</p>
      <label><input type="radio" name="rome2" value="a"> Iâ€™m loving your photos!</label><br>
      <label><input type="radio" name="rome2" value="b"> I love your photos. Do you want one of us together?</label><br>
      <label><input type="radio" name="rome2" value="c"> I like very your photos.</label>
      <div class="right" style="margin-top:10px">
        <button onclick="scoreRome()">Corriger</button>
        <button class="secondary" onclick="resetRome()">Reset</button>
      </div>
      <div id="romeRes" class="result"></div>
    </div>
  </details>

  <details>
    <summary><b>ğŸ Au restaurant (prÃ©sent / futur / conditionnel poli)</b></summary>
    <div class="card" id="restoBox">
      <p><b>ScÃ¨ne 1.</b> Commander poliment :</p>
      <label><input type="radio" name="resto1" value="a"> I want pasta and a glass of wine.</label><br>
      <label><input type="radio" name="resto1" value="b"> I would like the pasta and a glass of wine, please.</label><br>
      <label><input type="radio" name="resto1" value="c"> Give me pasta and wine, please.</label>
      <hr class="sep">
      <p><b>ScÃ¨ne 2.</b> Proposer :</p>
      <label><input type="radio" name="resto2" value="a"> Do you want to share a dessert?</label><br>
      <label><input type="radio" name="resto2" value="b"> Are you wanting to share dessert?</label><br>
      <label><input type="radio" name="resto2" value="c"> You share dessert?</label>
      <div class="right" style="margin-top:10px">
        <button onclick="scoreResto()">Corriger</button>
        <button class="secondary" onclick="resetResto()">Reset</button>
      </div>
      <div id="restoRes" class="result"></div>
    </div>
  </details>

  <details>
    <summary><b>ğŸ‰ Avec ses amis (prÃ©sent perfect / small talk)</b></summary>
    <div class="card" id="amisBox">
      <p><b>ScÃ¨ne 1.</b> Tu viens dâ€™Ãªtre prÃ©sentÃ© :</p>
      <label><input type="radio" name="amis1" value="a"> Happy to meet you! I know you since long time.</label><br>
      <label><input type="radio" name="amis1" value="b"> Nice to meet you! Iâ€™ve heard a lot about you.</label><br>
      <label><input type="radio" name="amis1" value="c"> Iâ€™m meeting you since 2020.</label>
      <hr class="sep">
      <p><b>ScÃ¨ne 2.</b> Faire la conversation :</p>
      <label><input type="radio" name="amis2" value="a"> How long do you live in Rome?</label><br>
      <label><input type="radio" name="amis2" value="b"> How long have you lived in Rome?</label><br>
      <label><input type="radio" name="amis2" value="c"> Since how much time you live here?</label>
      <div class="right" style="margin-top:10px">
        <button onclick="scoreAmis()">Corriger</button>
        <button class="secondary" onclick="resetAmis()">Reset</button>
      </div>
      <div id="amisRes" class="result"></div>
    </div>
  </details>

  <details>
    <summary><b>ğŸŒ¿ Ã€ lâ€™oliveraie (lexique huile dâ€™olive / prÃ©sent & passÃ©)</b></summary>
    <div class="card" id="oliveBox">
      <p><b>ScÃ¨ne 1.</b> Parler de la rÃ©colte :</p>
      <label><input type="radio" name="ol1" value="a"> The harvest start in October usually.</label><br>
      <label><input type="radio" name="ol1" value="b"> The harvest usually starts in October.</label><br>
      <label><input type="radio" name="ol1" value="c"> Usually the harvest starting in October.</label>
      <hr class="sep">
      <p><b>ScÃ¨ne 2.</b> Processus :</p>
      <label><input type="radio" name="ol2" value="a"> We pressed the olives the same day.</label><br>
      <label><input type="radio" name="ol2" value="b"> We press the olives the same day.</label><br>
      <label><input type="radio" name="ol2" value="c"> We are press the olives the same day.</label>
      <div class="right" style="margin-top:10px">
        <button onclick="scoreOlive()">Corriger</button>
        <button class="secondary" onclick="resetOlive()">Reset</button>
      </div>
      <div id="oliveRes" class="result"></div>
    </div>
  </details>
</section>

<!-- EXERCICES -->
<section id="exos">
  <h2>Exercices â€” auto-correction</h2>

  <h3>1) Choix multiples (auxiliaires & temps)</h3>
  <div class="card">
    <ol id="qcm">
      <li>How long ___ you been living here?
        <select data-answer="have">
          <option value="">â€”</option><option>has</option><option>have</option><option>did</option>
        </select>
        you been living here?
      </li>
      <li>What time ___ your train ___ ?
        <select data-answer="does"><option value="">â€”</option><option>do</option><option>does</option><option>is</option></select>
        <select data-answer="leave"><option value="">â€”</option><option>leaves</option><option>leave</option><option>lives</option></select>
        (today)
      </li>
      <li>Why ___ you tired today?
        <select data-answer="are"><option value="">â€”</option><option>do</option><option>are</option><option>were</option></select>
      </li>
    </ol>
    <div class="right">
      <button onclick="corrigerQCM()">Corriger</button>
      <button class="secondary" onclick="resetQCM()">Reset</button>
    </div>
    <div id="qcmRes" class="result"></div>
  </div>

  <h3>2) Traduction ciblÃ©e</h3>
  <div class="card">
    <p>â€œTu as un joli sourire.â€ â†’ 
      <input id="t1" type="text" placeholder="ex: You have a beautiful ..." />
    </p>
    <p>â€œDepuis combien de temps attends-tu le bus ?â€ â†’
      <input id="t2" type="text" placeholder="ex: How long have you ..." />
    </p>
    <div class="right">
      <button onclick="corrigerTrad()">Corriger</button>
      <button class="secondary" onclick="resetTrad()">Reset</button>
    </div>
    <div id="tradRes" class="result"></div>
  </div>

  <h3>3) Connecteurs (so / because / however / therefore)</h3>
  <div class="card">
    <p>I was tired, <input id="c1" type="text" placeholder="..." style="max-width:120px" /> I went home.</p>
    <p>I stayed home <input id="c2" type="text" placeholder="..." style="max-width:120px" /> it was raining.</p>
    <p>It was closed; <input id="c3" type="text" placeholder="..." style="max-width:120px" /> we left.</p>
    <div class="right">
      <button onclick="corrigerConn()">Corriger</button>
      <button class="secondary" onclick="resetConn()">Reset</button>
    </div>
    <div id="connRes" class="result"></div>
  </div>

  <h3>4) Ordre des mots (question â†’ phrase correcte)</h3>
  <div class="card">
    <p class="small muted">Exemple : *How long do you living here?* â†’ <b>How long have you been living here?</b></p>
    <textarea id="order1" rows="2" placeholder="Corrige : What time lives your train?"></textarea>
    <textarea id="order2" rows="2" placeholder="Corrige : Who have cooked the evening?"></textarea>
    <div class="right">
      <button onclick="showHints()">Besoin dâ€™indices</button>
    </div>
  </div>
</section>

<!-- PRONONCIATION -->
<section id="prononciation">
  <h2>Prononciation express (simplifiÃ©e)</h2>
  <ul>
    <li><b>th</b> : langue entre les dents â†’ <em>this</em> (zis), <em>think</em> (ssink doux).</li>
    <li><b>h</b> aspirÃ© : happy (ha-pi), house (haous).</li>
    <li><b>r</b> anglais lÃ©ger : girl (gueurl), tomorrow (te-mo-ro).</li>
    <li>Accent tonique : beau-TI-ful (biou-TI-feul), to-DAY (te-DÃ‰).</li>
    <li><b>beach</b> = bii-tch (voyelle longue) â€” pas â€œbitchâ€.</li>
  </ul>
</section>

<!-- CHECKLIST -->
<section id="checklist">
  <h2>Checklist quotidienne (sauvegardÃ©e)</h2>
  <div class="card">
    <label><input type="checkbox" class="ck" data-id="voc"> ğŸ“– Vocabulaire (10 min)</label>
    <label><input type="checkbox" class="ck" data-id="speak"> ğŸ—£ï¸ 5 phrases Ã  voix haute</label>
    <label><input type="checkbox" class="ck" data-id="write"> âœï¸ 1 mini-dialogue Ã©crit</label>
    <label><input type="checkbox" class="ck" data-id="listen"> ğŸ§ 5 min dâ€™Ã©coute</label>
    <label><input type="checkbox" class="ck" data-id="review"> âœ… Auto-Ã©valuation (fluide/prÃ©cis)</label>
    <div class="right" style="margin-top:8px">
      <button class="ghost" onclick="resetChecklist()">Reset checklist</button>
    </div>
  </div>
</section>

<!-- EXPORT -->
<section id="export">
  <h2>Exporter en PDF</h2>
  <p><span class="print-note">Astuce :</span> clique ci-dessous, puis choisis <b>Enregistrer en PDF</b>.</p>
  <button onclick="window.print()">ğŸ§¾ Exporter cette page en PDF</button>
</section>

<!-- REPONSES -->
<section id="reponses">
  <h2>RÃ©ponses (spoilers)</h2>
  <details>
    <summary><b>Afficher / cacher les rÃ©ponses</b></summary>
    <h3>QCM</h3>
    <ul>
      <li>have</li>
      <li>does + leave</li>
      <li>are</li>
    </ul>
    <h3>Traductions</h3>
    <ul>
      <li>You have a beautiful / lovely / cute smile.</li>
      <li>How long have you been waiting for the bus?</li>
    </ul>
    <h3>Connecteurs</h3>
    <ul>
      <li>so</li>
      <li>because</li>
      <li>therefore</li>
    </ul>
    <h3>Ordre des mots (suggestions)</h3>
    <ul>
      <li>What time <u>does your train leave</u>?</li>
      <li><u>Who cooked dinner?</u> / Who has cooked dinner?</li>
    </ul>
    <h3>ScÃ©narios</h3>
    <ul>
      <li>Rome : b + b</li>
      <li>Resto : b + a</li>
      <li>Amis : b + b</li>
      <li>Oliveraie : b + (b ou a selon prÃ©sent/habitude vs passÃ© prÃ©cis)</li>
    </ul>
  </details>
</section>

</main>

<footer>
  Cahier dâ€™Anglais â€“ V3 â€¢ Benny â€¢ Site autonome (HTML/CSS/JS) â€” <span class="small">Tu peux lâ€™exporter en PDF via Fichier â†’ Imprimer â†’ Enregistrer en PDF</span>
</footer>

<script>
/* ===================== QUESTION BUILDER ===================== */
function cap(s){return s? s[0].toUpperCase()+s.slice(1) : '';}
function ingForm(v){if(!v) return ''; // simple -ing rules
  if(/e$/.test(v) && !/ee$/.test(v)) return v.replace(/e$/,'')+'ing';
  if(/[aeiou][bcdfghjklmnpqrstvwxyz]$/.test(v)) return v+'ing';
  return v+'ing';
}
function pastPart(v){ // mini-liste + fallback -ed
  const irr={go:'gone',do:'done',be:'been',have:'had',eat:'eaten',make:'made',see:'seen',come:'come',get:'got',say:'said',write:'written',take:'taken',give:'given',know:'known',leave:'left',feel:'felt',find:'found',think:'thought',buy:'bought',bring:'brought',read:'read',drink:'drunk',drive:'driven'};
  if(irr[v]) return irr[v];
  if(/e$/.test(v)) return v+'d';
  if(/[bcdfghjklmnpqrstvwxyz]y$/.test(v)) return v.replace(/y$/,'ied');
  return v+'ed';
}
function buildQ(){
  const wh=document.getElementById('wh').value;
  const tense=document.getElementById('tense').value;
  const subj=document.getElementById('subj').value;
  const verb=(document.getElementById('verb').value||'').trim().toLowerCase();
  const compl=(document.getElementById('compl').value||'').trim();
  const time=(document.getElementById('time').value||'').trim();

  if(!subj || !verb || !tense){document.getElementById('qOut').innerHTML='<span class="warn">Choisis au moins Sujet, Verbe et Temps.</span>'; return;}
  let q='', aux='', be = (verb==='be');

  const S=subj.toLowerCase();
  const third = (S==='he'||S==='she');

  if(tense==='psimple'){
    if(be){
      aux = (S==='i')? 'am' : (third? 'is' : 'are');
      q = `${wh?wh+' ':''}${cap(aux)} ${S}${compl? ' '+compl:''}${time? ' '+time:''}?`;
    }else{
      aux = third? 'does':'do';
      q = `${wh?wh+' ':''}${cap(aux)} ${S} ${verb}${compl? ' '+compl:''}${time? ' '+time:''}?`;
    }
  }
  if(tense==='pcont'){
    const beAux = (S==='i')? 'am' : (third? 'is' : 'are');
    q = `${wh?wh+' ':''}${cap(beAux)} ${S} ${ingForm(verb)}${compl? ' '+compl:''}${time? ' '+time:''}?`;
  }
  if(tense==='past'){
    if(be){
      aux = (S==='we'||S==='they'||S==='you')? 'were':'was';
      q = `${wh?wh+' ':''}${cap(aux)} ${S}${compl? ' '+compl:''}${time? ' '+time:''}?`;
    }else{
      q = `${wh?wh+' ':''}Did ${S} ${verb}${compl? ' '+compl:''}${time? ' '+time:''}?`;
    }
  }
  if(tense==='will'){
    q = `${wh?wh+' ':''}Will ${S} ${be? 'be' : verb}${compl? ' '+compl:''}${time? ' '+time:''}?`;
  }
  if(tense==='perf'){
    const haveAux = third? 'Has' : 'Have';
    q = `${wh?wh+' ':''}${haveAux} ${S} ${pastPart(verb)}${compl? ' '+compl:''}${time? ' '+time:''}?`;
  }

  document.getElementById('qOut').innerHTML = `<b>${q}</b>`;
}

/* ===================== VOCAB DATA ===================== */
const VOC=[
  // Maison
  {en:'chair', ph:'tchÃ©Ã¨r', fr:'chaise', ex:'Iâ€™m sitting on the chair.', cat:'home'},
  {en:'table', ph:'tÃ©-bol', fr:'table', ex:'The keys are on the table.', cat:'home'},
  {en:'window', ph:'ouin-do', fr:'fenÃªtre', ex:'Open the window, please.', cat:'home'},
  {en:'bottle', ph:'bo-tol', fr:'bouteille', ex:'This bottle is full.', cat:'home'},
  {en:'key', ph:'ki', fr:'clÃ©', ex:'I canâ€™t find my key.', cat:'home'},
  {en:'stairs', ph:'stÃ¨rz', fr:'escaliers', ex:'The stairs are steep.', cat:'home'},
  {en:'towel', ph:'tao-el', fr:'serviette', ex:'I need a towel.', cat:'home'},
  {en:'broom', ph:'broum', fr:'balai', ex:'Where is the broom?', cat:'home'},
  {en:'sink', ph:'sink', fr:'Ã©vier', ex:'Clean the sink, please.', cat:'home'},
  {en:'fridge', ph:'fridj', fr:'frigo', ex:'Put it in the fridge.', cat:'home'},

  // Ville & nature
  {en:'river', ph:'ri-veur', fr:'riviÃ¨re', ex:'The river is calm.', cat:'city'},
  {en:'bridge', ph:'bridj', fr:'pont', ex:'We crossed the bridge.', cat:'city'},
  {en:'bench', ph:'bentch', fr:'banc', ex:'Letâ€™s sit on the bench.', cat:'city'},
  {en:'traffic light', ph:'trafik laÃ¯t', fr:'feu tricolore', ex:'Stop at the red light.', cat:'city'},
  {en:'fountain', ph:'faoun-tÃ¨n', fr:'fontaine', ex:'The fountain is beautiful.', cat:'city'},
  {en:'market', ph:'mar-ket', fr:'marchÃ©', ex:'The market opens early.', cat:'city'},
  {en:'beach', ph:'bii-tch', fr:'plage', ex:'We love the beach.', cat:'city'},
  {en:'sunset', ph:'son-set', fr:'coucher de soleil', ex:'The sunset looks amazing.', cat:'city'},
  {en:'fresh air', ph:'frÃ¨ch Ã¨r', fr:'air frais', ex:'I love breathing fresh air.', cat:'city'},
  {en:'harbor', ph:'har-beur', fr:'port', ex:'Boats are in the harbor.', cat:'city'},

  // Nourriture & resto
  {en:'starter', ph:'star-teur', fr:'entrÃ©e', ex:'What starter do you recommend?', cat:'food'},
  {en:'main course', ph:'mÃ¨Ã¯n kÃ´rss', fr:'plat principal', ex:'Iâ€™ll have the main course.', cat:'food'},
  {en:'dessert', ph:'di-zert', fr:'dessert', ex:'Letâ€™s share a dessert.', cat:'food'},
  {en:'bill / check', ph:'bil / tchek', fr:'addition', ex:'Could we have the bill, please?', cat:'food'},
  {en:'bottle of water', ph:'bo-tol ov-wo-teur', fr:'bouteille dâ€™eau', ex:'A bottle of water, please.', cat:'food'},
  {en:'olive oil', ph:'o-liv oÃ¯l', fr:'huile dâ€™olive', ex:'Drizzle olive oil on salad.', cat:'food'},
  {en:'rare / medium / well-done', ph:'rÃ¨r / mi-diom / ouel-done', fr:'saignant / Ã  point / bien cuit', ex:'Iâ€™d like it medium.', cat:'food'},
  {en:'to book a table', ph:'te bouk e tÃ©-bol', fr:'rÃ©server une table', ex:'We booked a table for 8.', cat:'food'},
  {en:'to order', ph:'o-deur', fr:'commander', ex:'Are you ready to order?', cat:'food'},
  {en:'tip', ph:'tip', fr:'pourboire', ex:'Do we leave a tip?', cat:'food'},

  // Voyage
  {en:'ticket', ph:'ti-ket', fr:'billet', ex:'Two tickets to Rome.', cat:'travel'},
  {en:'platform', ph:'plat-form', fr:'quai (gare)', ex:'The train leaves from platform 6.', cat:'travel'},
  {en:'luggage', ph:'leu-gÃ¨dj', fr:'bagages', ex:'Your luggage is heavy.', cat:'travel'},
  {en:'reservation', ph:'rÃ©-zer-vÃ¨-chon', fr:'rÃ©servation', ex:'I have a reservation.', cat:'travel'},
  {en:'guide', ph:'gaÃ¯de', fr:'guide', ex:'We hired a guide.', cat:'travel'},
  {en:'museum', ph:'miou-zi-ome', fr:'musÃ©e', ex:'The museum opens at 10.', cat:'travel'},
  {en:'map', ph:'map', fr:'carte', ex:'Do you have a map?', cat:'travel'},
  {en:'souvenir', ph:'sou-ve-nir', fr:'souvenir', ex:'Letâ€™s buy a souvenir.', cat:'travel'},
  {en:'hiking', ph:'haÃ¯-king', fr:'randonnÃ©e', ex:'Weâ€™re going hiking.', cat:'travel'},
  {en:'viewpoint', ph:'viou-point', fr:'point de vue', ex:'The viewpoint is stunning.', cat:'travel'},

  // Ã‰motions
  {en:'happy', ph:'ha-pi', fr:'heureux', ex:'I feel happy today.', cat:'feelings'},
  {en:'excited', ph:'ik-saÃ¯-tid', fr:'enthousiaste', ex:'Iâ€™m excited about tomorrow.', cat:'feelings'},
  {en:'calm', ph:'kaam', fr:'calme', ex:'Stay calm.', cat:'feelings'},
  {en:'surprised', ph:'sur-praÃ¯zd', fr:'surpris', ex:'She was surprised.', cat:'feelings'},
  {en:'jealous', ph:'dja-luss', fr:'jaloux', ex:'Donâ€™t be jealous.', cat:'feelings'},
  {en:'grateful', ph:'grÃ©Ã¯t-foul', fr:'reconnaissant', ex:'Iâ€™m grateful for your help.', cat:'feelings'},
  {en:'proud', ph:'praoud', fr:'fier', ex:'Iâ€™m proud of you.', cat:'feelings'},
  {en:'tired', ph:'taÃ¯-eurd', fr:'fatiguÃ©', ex:'Iâ€™m tired today.', cat:'feelings'},
  {en:'worried', ph:'wo-rid', fr:'inquiet', ex:'Donâ€™t be worried.', cat:'feelings'},
  {en:'relieved', ph:'ri-livd', fr:'soulagÃ©', ex:'I feel relieved now.', cat:'feelings'},

  // Travail
  {en:'meeting', ph:'mi-ting', fr:'rÃ©union', ex:'I have a meeting at 10.', cat:'work'},
  {en:'project', ph:'proj-ekt', fr:'projet', ex:'This project is urgent.', cat:'work'},
  {en:'deadline', ph:'dÃ¨d-laÃ¯ne', fr:'date limite', ex:'The deadline is Friday.', cat:'work'},
  {en:'task', ph:'task', fr:'tÃ¢che', ex:'This task is simple.', cat:'work'},
  {en:'report', ph:'ri-port', fr:'rapport', ex:'I wrote the report.', cat:'work'},
  {en:'client', ph:'klaÃ¯-ente', fr:'client', ex:'The client is happy.', cat:'work'},
  {en:'email', ph:'i-mail', fr:'email', ex:'I sent the email.', cat:'work'},
  {en:'office', ph:'of-iss', fr:'bureau', ex:'Iâ€™m at the office.', cat:'work'},
  {en:'schedule', ph:'skÃ¨-djoule', fr:'planning', ex:'Check the schedule.', cat:'work'},
  {en:'feedback', ph:'fiid-bak', fr:'retour', ex:'Thanks for the feedback.', cat:'work'},

  // Compliments & style
  {en:'beautiful', ph:'biou-ti-feul', fr:'beau/belle', ex:'You look beautiful today.', cat:'compl'},
  {en:'lovely dress', ph:'lov-li dres', fr:'jolie robe', ex:'Thatâ€™s a lovely dress.', cat:'compl'},
  {en:'gorgeous eyes', ph:'gor-djos aÃ¯z', fr:'yeux magnifiques', ex:'Your eyes are gorgeous.', cat:'compl'},
  {en:'nice skin', ph:'naÃ¯s skine', fr:'jolie peau', ex:'You have nice skin.', cat:'compl'},
  {en:'elegant', ph:'Ã©-li-gant', fr:'Ã©lÃ©gant(e)', ex:'You look elegant.', cat:'compl'},
  {en:'handsome', ph:'han-dsom', fr:'beau (homme)', ex:'You look handsome.', cat:'compl'},
  {en:'smile', ph:'smaÃ¯l', fr:'sourire', ex:'You have a lovely smile.', cat:'compl'},
  {en:'style', ph:'staÃ¯le', fr:'style', ex:'I like your style.', cat:'compl'},
  {en:'photo', ph:'fo-to', fr:'photo', ex:'Itâ€™s a beautiful photo of you.', cat:'compl'},
  {en:'charming', ph:'tchar-ming', fr:'charmant', ex:'You are charming.', cat:'compl'},

  // Huile dâ€™olive
  {en:'olive grove', ph:'o-liv grov', fr:'oliveraie', ex:'The olive grove is on the hill.', cat:'olive'},
  {en:'to harvest', ph:'har-vÃ¨st', fr:'rÃ©colter', ex:'We harvest in October.', cat:'olive'},
  {en:'harvest (noun)', ph:'har-vÃ¨st', fr:'rÃ©colte', ex:'The harvest was good.', cat:'olive'},
  {en:'press / mill', ph:'prÃ¨s / mil', fr:'pressoir / moulin', ex:'We press the olives the same day.', cat:'olive'},
  {en:'cold-pressed', ph:'kold-prÃ¨st', fr:'pressÃ©e Ã  froid', ex:'Cold-pressed extra virgin oil.', cat:'olive'},
  {en:'extra virgin', ph:'Ã¨k-stra veur-djin', fr:'extra-vierge', ex:'Extra virgin olive oil.', cat:'olive'},
  {en:'acidity', ph:'a-si-di-ti', fr:'aciditÃ©', ex:'Low acidity is desirable.', cat:'olive'},
  {en:'tasting notes', ph:'tÃ©-sting nots', fr:'notes de dÃ©gustation', ex:'Fruity with a peppery finish.', cat:'olive'},
  {en:'filtration', ph:'fil-trÃ©-chon', fr:'filtration', ex:'Filtered vs unfiltered oil.', cat:'olive'},
  {en:'bottling', ph:'bo-tling', fr:'embouteillage', ex:'Bottling happens on site.', cat:'olive'}
];

function renderVocab(){
  const q=(document.getElementById('vSearch').value||'').toLowerCase().trim();
  const cat=document.getElementById('vCat').value;
  const tbody=document.querySelector('#vTable tbody');
  tbody.innerHTML='';
  VOC.filter(x=>{
    const matchQ = !q || (x.en+' '+x.fr+' '+x.ph+' '+x.ex).toLowerCase().includes(q);
    const matchC = !cat || x.cat===cat;
    return matchQ && matchC;
  }).forEach(x=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${x.en}</td><td>${x.ph}</td><td>${x.fr}</td><td>${x.ex}</td><td>${x.cat}</td>`;
    tbody.appendChild(tr);
  });
}
function resetVocab(){ document.getElementById('vSearch').value=''; document.getElementById('vCat').value=''; renderVocab(); }

/* ===================== FLASHCARDS ===================== */
const FC = {
  home: VOC.filter(v=>v.cat==='home'),
  city: VOC.filter(v=>v.cat==='city'),
  food: VOC.filter(v=>v.cat==='food'),
  travel: VOC.filter(v=>v.cat==='travel'),
  feelings: VOC.filter(v=>v.cat==='feelings'),
  compl: VOC.filter(v=>v.cat==='compl'),
  olive: VOC.filter(v=>v.cat==='olive')
};
let fcIdx=0;
function fcData(){return FC[document.getElementById('fcSelect').value]||[];}
function fcShow(front=true){
  const data=fcData(); if(!data.length) return;
  fcIdx=(fcIdx+data.length)%data.length;
  const it=data[fcIdx];
  const card=document.getElementById('fcCard');
  card.dataset.side=front?'front':'back';
  card.innerHTML= front
    ? `<b>${it.en}</b><br><span class="muted">${it.ph}</span>`
    : `<b>${it.fr}</b><br><span class="muted">â†’ ${it.ex}</span>`;
}
function fcFlip(){const card=document.getElementById('fcCard'); fcShow(card.dataset.side!=='front');}
function fcNext(){fcIdx++; fcShow(true);}
function fcPrev(){fcIdx--; fcShow(true);}
document.getElementById('fcSelect').addEventListener('change',()=>{fcIdx=0;fcShow(true);});
window.addEventListener('keydown',e=>{ if(e.key==='ArrowRight') fcNext(); if(e.key==='ArrowLeft') fcPrev(); if(e.key===' ') fcFlip(); });

/* ===================== SCENARIOS SCORING ===================== */
function pick(name){const el=[...document.querySelectorAll(`input[name="${name}"]`)].find(x=>x.checked); return el? el.value:''; }
function scoreRome(){ const s1=pick('rome1')==='b', s2=pick('rome2')==='b'; const sc=(s1?1:0)+(s2?1:0); out('romeRes',sc,2); }
function resetRome(){ ['rome1','rome2'].forEach(n=>document.querySelectorAll(`input[name="${n}"]`).forEach(x=>x.checked=false)); out('romeRes',-1,2); }
function scoreResto(){ const s1=pick('resto1')==='b', s2=pick('resto2')==='a'; const sc=(s1?1:0)+(s2?1:0); out('restoRes',sc,2); }
function resetResto(){ ['resto1','resto2'].forEach(n=>document.querySelectorAll(`input[name="${n}"]`).forEach(x=>x.checked=false)); out('restoRes',-1,2); }
function scoreAmis(){ const s1=pick('amis1')==='b', s2=pick('amis2')==='b'; const sc=(s1?1:0)+(s2?1:0); out('amisRes',sc,2); }
function resetAmis(){ ['amis1','amis2'].forEach(n=>document.querySelectorAll(`input[name="${n}"]`).forEach(x=>x.checked=false)); out('amisRes',-1,2); }
function scoreOlive(){ const s1=pick('ol1')==='b', s2=['b','a'].includes(pick('ol2')); const sc=(s1?1:0)+(s2?1:0); out('oliveRes',sc,2); }
function resetOlive(){ ['ol1','ol2'].forEach(n=>document.querySelectorAll(`input[name="${n}"]`).forEach(x=>x.checked=false)); out('oliveRes',-1,2); }
function out(id,sc,total){ const el=document.getElementById(id); if(sc<0){el.textContent=''; return;} el.className='result '+(sc===total?'ok':(sc===0?'err':'warn')); el.textContent = sc===total? `âœ… Parfait : ${sc}/${total}` : `â„¹ï¸ Score : ${sc}/${total}`; }

/* ===================== EXOS HELPERS ===================== */
function norm(s){return (s||'').trim().toLowerCase().replace(/\s+/g,' ');}

/* QCM */
function corrigerQCM(){
  const selects=[...document.querySelectorAll('#qcm select')];
  let ok=0;
  selects.forEach(s=>{
    const good=s.dataset.answer.trim().toLowerCase();
    const val=(s.value||'').trim().toLowerCase();
    s.style.border='2px solid '+(val===good? '#16a34a' : '#ef4444');
    if(val===good) ok++;
  });
  const res=document.getElementById('qcmRes');
  res.textContent = ok===selects.length ? `âœ… Parfait : ${ok}/${selects.length}` : `â„¹ï¸ Score : ${ok}/${selects.length} â€” vois â€œRÃ©ponsesâ€.`;
  res.className='result ' + (ok===selects.length?'ok':'');
}
function resetQCM(){ document.querySelectorAll('#qcm select').forEach(s=>{s.value=''; s.style.border='1px solid #dbeafe'}); document.getElementById('qcmRes').textContent=''; }

/* Traductions */
function corrigerTrad(){
  const t1=norm(document.getElementById('t1').value);
  const t2=norm(document.getElementById('t2').value);
  let pts=0;
  const ok1=['you have a beautiful smile','you have a lovely smile','you have a cute smile'];
  if(ok1.includes(t1)) pts++;
  if(t2==='how long have you been waiting for the bus?') pts++;
  const res=document.getElementById('tradRes');
  res.textContent = pts===2 ? 'âœ… Parfait : 2/2' : `â„¹ï¸ Score : ${pts}/2 â€” vois â€œRÃ©ponsesâ€.`;
  res.className='result ' + (pts===2?'ok':'');
}
function resetTrad(){ ['t1','t2'].forEach(id=>document.getElementById(id).value=''); document.getElementById('tradRes').textContent=''; }

/* Connecteurs */
function corrigerConn(){
  const c1=norm(document.getElementById('c1').value);
  const c2=norm(document.getElementById('c2').value);
  const c3=norm(document.getElementById('c3').value);
  let pts=0;
  if(c1==='so') pts++;
  if(c2==='because') pts++;
  if(c3==='therefore'||c3==='so'/* tolÃ©rance */) pts++;
  const res=document.getElementById('connRes');
  res.textContent = (pts===3)? 'âœ… Parfait : 3/3' : `â„¹ï¸ Score : ${pts}/3 â€” vois â€œRÃ©ponsesâ€.`;
  res.className='result ' + (pts===3?'ok':'');
}
function resetConn(){ ['c1','c2','c3'].forEach(id=>document.getElementById(id).value=''); document.getElementById('connRes').textContent=''; }

/* Ordre â€” hints */
function showHints(){
  const o1=document.getElementById('order1'); const o2=document.getElementById('order2');
  if(!o1.value) o1.value='Hint: What time does your train leave?';
  if(!o2.value) o2.value='Hint: Who cooked dinner?';
}

/* ===================== CHECKLIST ===================== */
const CK_KEYS=['voc','speak','write','listen','review'];
document.querySelectorAll('.ck').forEach(cb=>{
  const k='ck_'+cb.dataset.id;
  cb.checked = localStorage.getItem(k)==='1';
  cb.addEventListener('change',()=> localStorage.setItem(k, cb.checked?'1':'0'));
});
function resetChecklist(){ document.querySelectorAll('.ck').forEach(cb=>{cb.checked=false; localStorage.setItem('ck_'+cb.dataset.id,'0')}); }

/* ===================== INIT ===================== */
function init(){
  renderVocab();
  fcShow(true);
}
window.addEventListener('load', init);
</script>
</body>
</html>
